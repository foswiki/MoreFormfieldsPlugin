"use strict";!function(e){var t={selector:"input",separator:",",sortable:!0};function i(i,n){var o=this;o.elem=e(i),o.opts=e.extend({},t,o.elem.data(),n),o.init()}i.prototype.init=function(){var t=this;t.elem.wrap("<div class='jqMultiTextInputWrapper orig'></div>"),t.container=t.elem.parent().wrap("<div class='jqMultiTextContainer jqMultiText inited'></div>").parent(),t.container.data({multiText:t}).attr("data-name",t.elem.attr("name")),t.opts.sortable&&t.container.sortable({items:"> .jqMultiTextInputWrapper"}),t.elem.on("focus blur keydown",(function(i){var n=e(this);if(void 0!==t.timer&&window.clearTimeout(t.timer),t.timer=window.setTimeout((function(){t.updateFields()}),250),"keydown"===i.type&&13==i.keyCode&&""!==n.val())return n.parent().next().find(t.opts.selector).focus(),!1}));var i=t.elem.val();t.setValue(i)},i.prototype.clear=function(){this.container.children(":not(.orig)").remove(),this.elem.val("")},i.prototype.getValue=function(){var e=[];return this.container.find("input").each((function(){""!==this.value&&e.push(this.value)})),e},i.prototype.setValue=function(t){var i=this,n=decodeURIComponent(i.opts.separator),o=new RegExp("\\s*"+n+"\\s*");i.clear(),void 0!==t&&""!==t&&("string"==typeof t&&""!==t&&(t=(t=decodeURIComponent(t)).split(o)),e.each(t,(function(e,t){e?i.createField(t):i.elem.val(t)})),i.createField())},i.prototype.appendValue=function(e){var t=this.getValue();t.push(e),this.setValue(t)},i.prototype.updateFields=function(){var e,t=this;(e=t.container.find(t.opts.selector).not(":focus").filter((function(){return""===this.value}))).length<1&&t.createField(),e.length>1&&e.slice(0,-1).remove()},i.prototype.createField=function(e){var t,i=this;void 0===e&&(e=""),(t=i.elem.clone(!0)).removeClass("foswikiMandatory valid jqMultiText").removeAttr("value").val(e).wrap("<div class='jqMultiTextInputWrapper'></div>").parent().appendTo(i.container),i.elem.trigger("update",t)},e.fn.multiText=function(e){return this.each((function(){new i(this,e)}))},e((function(){e(".jqMultiText:not(.inited)").livequery((function(){e(this).multiText()}))}))}(jQuery);
